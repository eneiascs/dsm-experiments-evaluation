Vagrant.configure("2") do |config|
  config.vm.box = "trusty64"
  config.vm.box_url = "https://cloud-images.ubuntu.com/vagrant/trusty/current/trusty-server-cloudimg-amd64-vagrant-disk1.box"
  
  config.vm.provider "virtualbox" do |vb|
    vb.customize ["modifyvm", :id, "--memory", 4096]
    vb.customize ["modifyvm", :id, "--ioapic", "on", "--cpus", 4]
    vb.name = "dohkojob"
  end

  config.vm.network "private_network", ip: "10.10.3.12"
  config.vm.network "forwarded_port", guest: 80, host: 8080
  config.vm.network "forwarded_port", guest: 3300, host: 3300

  config.vm.synced_folder ".", "/vagrant", disable: true
  config.vm.synced_folder ".", "/home/vagrant/workspace", disable: false
 
  config.vm.provision :docker
  config.vm.provision :docker_compose,
	               compose_version: '1.20.1'

  config.vm.provision "shell", inline: <<-SHELL
     apt-get update && apt-get install -y r-base
     pushd /home/vagrant/workspace; docker-compose up --force-recreate	
  SHELL


end
